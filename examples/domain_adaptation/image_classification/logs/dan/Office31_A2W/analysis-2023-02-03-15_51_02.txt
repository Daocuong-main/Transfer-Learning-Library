Namespace(arch='resnet50', batch_size=32, bottleneck_dim=256, data='Office31', epochs=10, iters_per_epoch=10, log='logs/dan/Office31_A2W', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_hflip=False, no_pool=False, non_linear=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='analysis', print_freq=100, ratio=[0.75, 1.3333333333333333], resize_size=224, root='data/office31', scale=[0.08, 1.0], scratch=False, seed=1, source=['A'], target=['W'], trade_off=1.0, train_resizing='default', val_resizing='default', wd=0.0005, workers=2)
dan.py:40: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
  0%|          | 0/88 [00:00<?, ?it/s]  1%|1         | 1/88 [00:02<03:32,  2.44s/it]  2%|2         | 2/88 [00:03<03:06,  2.17s/it]  3%|3         | 3/88 [00:05<02:47,  1.97s/it]  5%|4         | 4/88 [00:07<02:43,  1.94s/it]  6%|5         | 5/88 [00:08<02:32,  1.84s/it]  7%|6         | 6/88 [00:10<02:23,  1.75s/it]  8%|7         | 7/88 [00:12<02:27,  1.82s/it]  9%|9         | 8/88 [00:14<02:22,  1.78s/it] 10%|#         | 9/88 [00:15<02:20,  1.78s/it] 11%|#1        | 10/88 [00:17<02:20,  1.80s/it] 12%|#2        | 11/88 [00:19<02:13,  1.74s/it] 14%|#3        | 12/88 [00:21<02:09,  1.70s/it] 15%|#4        | 13/88 [00:23<02:19,  1.86s/it] 16%|#5        | 14/88 [00:24<02:14,  1.82s/it] 17%|#7        | 15/88 [00:26<02:07,  1.75s/it] 18%|#8        | 16/88 [00:28<02:11,  1.83s/it] 19%|#9        | 17/88 [00:30<02:06,  1.78s/it] 20%|##        | 18/88 [00:31<02:01,  1.73s/it] 22%|##1       | 19/88 [00:33<01:59,  1.73s/it] 23%|##2       | 20/88 [00:35<01:54,  1.68s/it] 24%|##3       | 21/88 [00:36<01:48,  1.62s/it] 25%|##5       | 22/88 [00:38<01:59,  1.81s/it] 26%|##6       | 23/88 [00:40<01:52,  1.72s/it] 27%|##7       | 24/88 [00:41<01:45,  1.65s/it] 28%|##8       | 25/88 [00:43<01:47,  1.70s/it] 30%|##9       | 26/88 [00:45<01:41,  1.64s/it] 31%|###       | 27/88 [00:46<01:38,  1.62s/it] 32%|###1      | 28/88 [00:48<01:42,  1.71s/it] 33%|###2      | 29/88 [00:50<01:46,  1.80s/it] 34%|###4      | 30/88 [00:52<01:45,  1.83s/it] 35%|###5      | 31/88 [00:54<01:47,  1.89s/it] 36%|###6      | 32/88 [00:56<01:42,  1.83s/it] 38%|###7      | 33/88 [00:57<01:34,  1.73s/it] 39%|###8      | 34/88 [00:59<01:35,  1.76s/it] 40%|###9      | 35/88 [01:01<01:28,  1.67s/it] 41%|####      | 36/88 [01:02<01:23,  1.61s/it] 42%|####2     | 37/88 [01:04<01:25,  1.67s/it] 43%|####3     | 38/88 [01:05<01:21,  1.63s/it] 44%|####4     | 39/88 [01:07<01:16,  1.57s/it] 45%|####5     | 40/88 [01:09<01:20,  1.68s/it] 47%|####6     | 41/88 [01:10<01:16,  1.63s/it] 48%|####7     | 42/88 [01:12<01:12,  1.58s/it] 49%|####8     | 43/88 [01:13<01:11,  1.59s/it] 50%|#####     | 44/88 [01:15<01:11,  1.62s/it] 51%|#####1    | 45/88 [01:16<01:06,  1.54s/it] 52%|#####2    | 46/88 [01:18<01:03,  1.52s/it] 53%|#####3    | 47/88 [01:19<01:03,  1.54s/it] 55%|#####4    | 48/88 [01:21<01:01,  1.54s/it] 56%|#####5    | 49/88 [01:23<00:59,  1.53s/it] 57%|#####6    | 50/88 [01:24<00:58,  1.53s/it] 58%|#####7    | 51/88 [01:25<00:55,  1.50s/it] 59%|#####9    | 52/88 [01:27<00:53,  1.49s/it] 60%|######    | 53/88 [01:28<00:51,  1.48s/it] 61%|######1   | 54/88 [01:30<00:49,  1.45s/it] 62%|######2   | 55/88 [01:31<00:47,  1.45s/it] 64%|######3   | 56/88 [01:33<00:46,  1.44s/it] 65%|######4   | 57/88 [01:34<00:44,  1.43s/it] 66%|######5   | 58/88 [01:35<00:42,  1.42s/it] 67%|######7   | 59/88 [01:37<00:41,  1.43s/it] 68%|######8   | 60/88 [01:38<00:40,  1.44s/it] 69%|######9   | 61/88 [01:40<00:39,  1.45s/it] 70%|#######   | 62/88 [01:41<00:36,  1.42s/it] 72%|#######1  | 63/88 [01:43<00:35,  1.44s/it] 73%|#######2  | 64/88 [01:44<00:34,  1.44s/it] 74%|#######3  | 65/88 [01:45<00:31,  1.39s/it] 75%|#######5  | 66/88 [01:47<00:31,  1.43s/it] 76%|#######6  | 67/88 [01:48<00:30,  1.47s/it] 77%|#######7  | 68/88 [01:50<00:29,  1.46s/it] 78%|#######8  | 69/88 [01:51<00:28,  1.48s/it] 80%|#######9  | 70/88 [01:53<00:26,  1.48s/it] 81%|########  | 71/88 [01:54<00:24,  1.46s/it] 82%|########1 | 72/88 [01:56<00:22,  1.43s/it] 83%|########2 | 73/88 [01:57<00:21,  1.42s/it] 84%|########4 | 74/88 [01:58<00:19,  1.39s/it] 85%|########5 | 75/88 [02:00<00:18,  1.41s/it] 86%|########6 | 76/88 [02:01<00:16,  1.38s/it] 88%|########7 | 77/88 [02:03<00:15,  1.41s/it] 89%|########8 | 78/88 [02:04<00:14,  1.44s/it] 90%|########9 | 79/88 [02:06<00:12,  1.44s/it] 91%|######### | 80/88 [02:07<00:11,  1.43s/it] 92%|#########2| 81/88 [02:08<00:10,  1.45s/it] 93%|#########3| 82/88 [02:10<00:08,  1.40s/it] 94%|#########4| 83/88 [02:11<00:07,  1.40s/it] 95%|#########5| 84/88 [02:13<00:05,  1.44s/it] 97%|#########6| 85/88 [02:14<00:04,  1.39s/it] 98%|#########7| 86/88 [02:15<00:02,  1.38s/it] 99%|#########8| 87/88 [02:17<00:01,  1.34s/it]100%|##########| 88/88 [02:18<00:00,  1.35s/it]100%|##########| 88/88 [02:18<00:00,  1.57s/it]
  0%|          | 0/24 [00:00<?, ?it/s]  4%|4         | 1/24 [00:02<00:52,  2.27s/it]  8%|8         | 2/24 [00:04<00:46,  2.13s/it] 12%|#2        | 3/24 [00:05<00:42,  2.02s/it] 17%|#6        | 4/24 [00:07<00:38,  1.94s/it] 21%|##        | 5/24 [00:09<00:35,  1.88s/it] 25%|##5       | 6/24 [00:11<00:33,  1.87s/it] 29%|##9       | 7/24 [00:13<00:31,  1.88s/it] 33%|###3      | 8/24 [00:14<00:29,  1.84s/it] 38%|###7      | 9/24 [00:16<00:27,  1.83s/it] 42%|####1     | 10/24 [00:18<00:25,  1.84s/it] 46%|####5     | 11/24 [00:20<00:24,  1.85s/it] 50%|#####     | 12/24 [00:22<00:22,  1.86s/it] 54%|#####4    | 13/24 [00:24<00:20,  1.85s/it] 58%|#####8    | 14/24 [00:25<00:17,  1.80s/it] 62%|######2   | 15/24 [00:27<00:16,  1.81s/it] 67%|######6   | 16/24 [00:29<00:14,  1.78s/it] 71%|#######   | 17/24 [00:31<00:12,  1.80s/it] 75%|#######5  | 18/24 [00:33<00:10,  1.82s/it] 79%|#######9  | 19/24 [00:34<00:09,  1.86s/it] 83%|########3 | 20/24 [00:36<00:07,  1.84s/it] 88%|########7 | 21/24 [00:38<00:05,  1.80s/it] 92%|#########1| 22/24 [00:40<00:03,  1.80s/it] 96%|#########5| 23/24 [00:42<00:01,  1.78s/it]100%|##########| 24/24 [00:43<00:00,  1.79s/it]100%|##########| 24/24 [00:43<00:00,  1.83s/it]
Saving t-SNE to logs/dan/Office31_A2W/visualize/TSNE.pdf
epoch 0 accuracy: 86.88981628417969 A-dist: 1.4755926132202148
epoch 1 accuracy: 91.07392120361328 A-dist: 1.6429567337036133
epoch 2 accuracy: 93.3054428100586 A-dist: 1.732217788696289
epoch 3 accuracy: 91.07392120361328 A-dist: 1.6429567337036133
epoch 4 accuracy: 94.28173065185547 A-dist: 1.7712693214416504
epoch 5 accuracy: 93.72384643554688 A-dist: 1.7489538192749023
epoch 6 accuracy: 94.42119598388672 A-dist: 1.7768478393554688
epoch 7 accuracy: 95.67642974853516 A-dist: 1.827057123184204
epoch 8 accuracy: 94.97908020019531 A-dist: 1.7991631031036377
epoch 9 accuracy: 95.25801849365234 A-dist: 1.8103208541870117
A-distance = tensor(1.8103)
