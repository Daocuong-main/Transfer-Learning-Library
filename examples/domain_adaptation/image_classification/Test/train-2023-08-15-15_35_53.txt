Namespace(arch='resnet101', batch_size=8, bottleneck_dim=256, byte_size=32, data='Both', epochs=3, iters_per_epoch=10, label=3, log='Test/', loss_function='MKMMD', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scenario='S2T', scratch=False, seed=None, test_statistic='none', trade_off=1.0, wd=0.0005, workers=2)
Concate data
num_classes: 3
=> using model 'resnet101'
Downloading: "https://download.pytorch.org/models/resnet101-63fe2227.pth" to /home/bkcs/.cache/torch/hub/checkpoints/resnet101-63fe2227.pth
  0%|          | 0.00/171M [00:00<?, ?B/s]  2%|1         | 2.88M/171M [00:00<00:05, 29.9MB/s]  4%|4         | 7.03M/171M [00:00<00:04, 37.9MB/s]  6%|6         | 10.9M/171M [00:00<00:04, 39.2MB/s]  9%|8         | 14.7M/171M [00:00<00:07, 22.6MB/s] 10%|#         | 17.5M/171M [00:00<00:08, 19.6MB/s] 12%|#1        | 19.8M/171M [00:00<00:08, 19.1MB/s] 13%|#2        | 21.8M/171M [00:01<00:09, 16.8MB/s] 14%|#3        | 23.6M/171M [00:01<00:09, 15.8MB/s] 15%|#4        | 25.3M/171M [00:01<00:10, 14.7MB/s] 16%|#5        | 26.9M/171M [00:01<00:09, 15.2MB/s] 17%|#6        | 28.4M/171M [00:01<00:10, 14.9MB/s] 18%|#7        | 29.9M/171M [00:01<00:10, 14.3MB/s] 18%|#8        | 31.3M/171M [00:01<00:10, 14.2MB/s] 19%|#9        | 32.7M/171M [00:01<00:10, 14.2MB/s] 20%|#9        | 34.0M/171M [00:02<00:10, 13.7MB/s] 21%|##        | 35.3M/171M [00:02<00:10, 13.5MB/s] 21%|##1       | 36.6M/171M [00:02<00:10, 13.2MB/s] 22%|##2       | 37.9M/171M [00:02<00:10, 13.3MB/s] 23%|##3       | 39.2M/171M [00:02<00:10, 13.3MB/s] 24%|##3       | 40.5M/171M [00:02<00:10, 13.0MB/s] 24%|##4       | 41.7M/171M [00:02<00:10, 12.7MB/s] 25%|##5       | 43.0M/171M [00:02<00:10, 12.4MB/s] 26%|##5       | 44.1M/171M [00:02<00:11, 12.0MB/s] 27%|##6       | 45.3M/171M [00:03<00:11, 11.7MB/s] 27%|##7       | 46.5M/171M [00:03<00:11, 11.7MB/s] 28%|##8       | 47.8M/171M [00:03<00:10, 12.2MB/s] 29%|##8       | 49.2M/171M [00:03<00:09, 12.8MB/s] 30%|##9       | 50.5M/171M [00:03<00:09, 12.9MB/s] 30%|###       | 51.9M/171M [00:03<00:09, 12.9MB/s] 31%|###1      | 53.1M/171M [00:03<00:09, 13.1MB/s] 32%|###1      | 54.5M/171M [00:03<00:09, 13.5MB/s] 33%|###2      | 55.8M/171M [00:03<00:08, 13.4MB/s] 33%|###3      | 57.1M/171M [00:03<00:08, 13.4MB/s] 34%|###4      | 58.4M/171M [00:04<00:08, 13.4MB/s] 35%|###4      | 59.7M/171M [00:04<00:08, 13.4MB/s] 36%|###5      | 61.0M/171M [00:04<00:08, 13.5MB/s] 37%|###6      | 62.3M/171M [00:04<00:08, 13.3MB/s] 37%|###7      | 63.6M/171M [00:04<00:08, 13.0MB/s] 38%|###8      | 64.9M/171M [00:04<00:08, 13.2MB/s] 39%|###8      | 66.2M/171M [00:04<00:08, 13.0MB/s] 40%|###9      | 67.4M/171M [00:04<00:08, 12.8MB/s] 40%|####      | 68.9M/171M [00:04<00:07, 13.6MB/s] 41%|####1     | 70.2M/171M [00:04<00:07, 13.5MB/s] 42%|####1     | 71.5M/171M [00:05<00:07, 13.4MB/s] 43%|####2     | 72.8M/171M [00:05<00:07, 13.4MB/s] 43%|####3     | 74.1M/171M [00:05<00:07, 13.2MB/s] 44%|####4     | 75.4M/171M [00:05<00:08, 11.7MB/s] 45%|####4     | 76.7M/171M [00:05<00:07, 12.4MB/s] 46%|####5     | 78.0M/171M [00:05<00:07, 12.8MB/s] 47%|####6     | 79.3M/171M [00:05<00:07, 12.3MB/s] 47%|####7     | 80.5M/171M [00:05<00:07, 11.9MB/s] 48%|####8     | 81.9M/171M [00:05<00:07, 12.6MB/s] 49%|####8     | 83.2M/171M [00:06<00:07, 12.8MB/s] 50%|####9     | 84.5M/171M [00:06<00:06, 12.9MB/s] 50%|#####     | 85.7M/171M [00:06<00:06, 12.8MB/s] 51%|#####1    | 87.0M/171M [00:06<00:06, 12.9MB/s] 52%|#####1    | 88.3M/171M [00:06<00:06, 13.1MB/s] 53%|#####2    | 89.6M/171M [00:06<00:06, 13.2MB/s] 53%|#####3    | 90.9M/171M [00:06<00:06, 13.2MB/s] 54%|#####4    | 92.2M/171M [00:06<00:06, 13.1MB/s] 55%|#####4    | 93.5M/171M [00:06<00:06, 13.0MB/s] 56%|#####5    | 94.7M/171M [00:06<00:06, 12.7MB/s] 56%|#####6    | 96.2M/171M [00:07<00:05, 13.6MB/s] 57%|#####7    | 97.6M/171M [00:07<00:05, 13.4MB/s] 58%|#####7    | 98.8M/171M [00:07<00:05, 13.4MB/s] 59%|#####8    | 100M/171M [00:07<00:05, 13.1MB/s]  60%|#####9    | 101M/171M [00:07<00:05, 13.3MB/s] 60%|######    | 103M/171M [00:07<00:05, 13.1MB/s] 61%|######    | 104M/171M [00:07<00:05, 13.0MB/s] 62%|######1   | 105M/171M [00:07<00:05, 12.9MB/s] 63%|######2   | 107M/171M [00:07<00:05, 13.1MB/s] 63%|######3   | 108M/171M [00:08<00:04, 13.1MB/s] 64%|######4   | 109M/171M [00:08<00:04, 13.0MB/s] 65%|######4   | 110M/171M [00:08<00:04, 13.0MB/s] 66%|######5   | 112M/171M [00:08<00:04, 13.3MB/s] 66%|######6   | 113M/171M [00:08<00:04, 13.2MB/s] 67%|######7   | 114M/171M [00:08<00:04, 13.2MB/s] 68%|######7   | 116M/171M [00:08<00:04, 13.5MB/s] 69%|######8   | 117M/171M [00:08<00:04, 13.6MB/s] 69%|######9   | 118M/171M [00:08<00:04, 13.4MB/s] 70%|#######   | 120M/171M [00:08<00:03, 14.1MB/s] 71%|#######1  | 121M/171M [00:09<00:03, 13.9MB/s] 72%|#######2  | 123M/171M [00:09<00:03, 14.5MB/s] 73%|#######2  | 124M/171M [00:09<00:03, 14.0MB/s] 74%|#######3  | 126M/171M [00:09<00:03, 14.5MB/s] 75%|#######4  | 127M/171M [00:09<00:03, 14.4MB/s] 75%|#######5  | 129M/171M [00:09<00:03, 14.0MB/s] 76%|#######6  | 130M/171M [00:09<00:03, 13.8MB/s] 77%|#######7  | 131M/171M [00:09<00:02, 14.0MB/s] 78%|#######7  | 133M/171M [00:09<00:02, 13.5MB/s] 79%|#######8  | 134M/171M [00:10<00:02, 13.5MB/s] 79%|#######9  | 135M/171M [00:10<00:02, 13.3MB/s] 80%|########  | 137M/171M [00:10<00:02, 13.0MB/s] 81%|########  | 138M/171M [00:10<00:02, 12.8MB/s] 82%|########1 | 139M/171M [00:10<00:02, 12.5MB/s] 82%|########2 | 140M/171M [00:10<00:02, 12.4MB/s] 83%|########2 | 141M/171M [00:10<00:03, 8.35MB/s] 84%|########4 | 143M/171M [00:10<00:02, 10.9MB/s] 86%|########5 | 146M/171M [00:11<00:01, 14.8MB/s] 87%|########7 | 148M/171M [00:11<00:01, 17.2MB/s] 88%|########8 | 150M/171M [00:11<00:01, 17.1MB/s] 89%|########9 | 152M/171M [00:11<00:01, 16.0MB/s] 90%|######### | 154M/171M [00:11<00:01, 14.8MB/s] 91%|######### | 155M/171M [00:11<00:01, 12.6MB/s] 93%|#########2| 158M/171M [00:11<00:00, 15.9MB/s] 94%|#########3| 159M/171M [00:11<00:00, 15.7MB/s] 94%|#########4| 161M/171M [00:12<00:00, 15.2MB/s] 95%|#########5| 163M/171M [00:12<00:00, 14.9MB/s] 96%|#########6| 164M/171M [00:12<00:00, 14.6MB/s] 97%|#########7| 165M/171M [00:12<00:00, 14.6MB/s] 98%|#########7| 167M/171M [00:12<00:00, 14.5MB/s] 99%|#########8| 168M/171M [00:12<00:00, 14.2MB/s] 99%|#########9| 170M/171M [00:12<00:00, 14.1MB/s]100%|##########| 171M/171M [00:12<00:00, 14.0MB/s]
Epoch: [0][ 0/10]	Time 1.09 (1.09)	Data 0.0 (0.0)	Loss 1.42 (1.42)	Trans Loss 0.2029 (0.2029)	Cls Acc 37.5 (37.5)
Test: [  0/185]	Time  0.063 ( 0.063)	Loss 9.2586e-01 (9.2586e-01)	Acc@1 100.00 (100.00)
Test: [100/185]	Time  0.006 ( 0.007)	Loss 8.2907e-01 (1.0494e+00)	Acc@1 100.00 ( 67.20)
 * Acc@1 52.90934
 * F1 macro = 0.48508
 * F1 micro= 0.52909
 * precision macro= 0.48579
 * precision micro= 0.52909
 * recall macro = 0.49865
 * recall micro = 0.52909
global correct: 52.9
mean correct:33.0
mean IoU: 18.0
+------------------+--------------------+--------------------+
|      class       |        acc         |        iou         |
+------------------+--------------------+--------------------+
|    E-commerce    | 97.86432647705078  | 52.813560485839844 |
| Video on-demand  | 1.1538461446762085 | 1.083032488822937  |
| Interactive data |        0.0         |        0.0         |
+------------------+--------------------+--------------------+
Epoch: [1][ 0/10]	Time 0.05 (0.05)	Data 0.0 (0.0)	Loss 1.10 (1.10)	Trans Loss 0.1550 (0.1550)	Cls Acc 62.5 (62.5)
Test: [  0/185]	Time  0.126 ( 0.126)	Loss 7.9454e-01 (7.9454e-01)	Acc@1  75.00 ( 75.00)
Test: [100/185]	Time  0.007 ( 0.008)	Loss 7.0494e-01 (6.6876e-01)	Acc@1 100.00 ( 87.62)
 * Acc@1 62.58457
 * F1 macro = 0.48756
 * F1 micro= 0.62585
 * precision macro= 0.51119
 * precision micro= 0.62585
 * recall macro = 0.47396
 * recall micro = 0.62585
global correct: 62.6
mean correct:58.5
mean IoU: 35.8
+------------------+-------------------+--------------------+
|      class       |        acc        |        iou         |
+------------------+-------------------+--------------------+
|    E-commerce    | 87.43718719482422 | 70.16128540039062  |
| Video on-demand  |  88.0769271850586 | 37.115074157714844 |
| Interactive data |        0.0        |        0.0         |
+------------------+-------------------+--------------------+
Epoch: [2][ 0/10]	Time 0.05 (0.05)	Data 0.0 (0.0)	Loss 1.28 (1.28)	Trans Loss 0.4228 (0.4228)	Cls Acc 75.0 (75.0)
Test: [  0/185]	Time  0.063 ( 0.063)	Loss 9.3211e-01 (9.3211e-01)	Acc@1  75.00 ( 75.00)
Test: [100/185]	Time  0.006 ( 0.008)	Loss 7.7869e-01 (7.2075e-01)	Acc@1  87.50 ( 83.17)
 * Acc@1 59.13396
 * F1 macro = 0.41570
 * F1 micro= 0.59134
 * precision macro= 0.47224
 * precision micro= 0.59134
 * recall macro = 0.39324
 * recall micro = 0.59134
global correct: 59.1
mean correct:58.6
mean IoU: 35.8
+------------------+-------------------+--------------------+
|      class       |        acc        |        iou         |
+------------------+-------------------+--------------------+
|    E-commerce    | 77.01004791259766 | 74.39320373535156  |
| Video on-demand  | 96.15384674072266 | 30.599754333496094 |
| Interactive data | 2.606635093688965 | 2.494331121444702  |
+------------------+-------------------+--------------------+
Elapsed time: 12.021025896072388
best_acc1 = 62.58457
Test: [  0/185]	Time  0.070 ( 0.070)	Loss 7.9454e-01 (7.9454e-01)	Acc@1  75.00 ( 75.00)
Test: [100/185]	Time  0.007 ( 0.008)	Loss 7.0494e-01 (6.6876e-01)	Acc@1 100.00 ( 87.62)
 * Acc@1 62.58457
 * F1 macro = 0.48756
 * F1 micro= 0.62585
 * precision macro= 0.51119
 * precision micro= 0.62585
 * recall macro = 0.47396
 * recall micro = 0.62585
global correct: 62.6
mean correct:58.5
mean IoU: 35.8
+------------------+-------------------+--------------------+
|      class       |        acc        |        iou         |
+------------------+-------------------+--------------------+
|    E-commerce    | 87.43718719482422 | 70.16128540039062  |
| Video on-demand  |  88.0769271850586 | 37.115074157714844 |
| Interactive data |        0.0        |        0.0         |
+------------------+-------------------+--------------------+
Test result below...
test_acc1 = 62.58457
F1 macro = 0.48756
F1 micro= 0.62585
precision macro= 0.51119
precision micro= 0.62585
recall macro = 0.47396
recall micro = 0.62585
avg_time = 4.25405
min_time = 4.00000
max_time = 9.00000
                  precision    recall  f1-score   support

      E-commerce    0.78027   0.87437   0.82464       796
 Video on-demand    0.39078   0.88077   0.54137       260
Interactive data    0.00000   0.00000   0.00000       422

        accuracy                        0.62585      1478
       macro avg    0.39035   0.58505   0.45534      1478
    weighted avg    0.48897   0.62585   0.53936      1478

