Namespace(arch='vit_base_patch32_224_clip_laion2b', batch_size=8, bottleneck_dim=256, byte_size=256, data='Both', epochs=2, iters_per_epoch=2, label=3, log='Test/', loss_function='MKMMD', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scenario='S2T', scratch=False, seed=None, test_statistic='none', trade_off=1.0, wd=0.0005, workers=2)
Concate data
num_classes: 3
=> using model 'vit_base_patch32_224_clip_laion2b'
Downloading (…)ip_pytorch_model.bin:   0%|          | 0.00/605M [00:00<?, ?B/s]Downloading (…)ip_pytorch_model.bin:   2%|1         | 10.5M/605M [00:00<00:41, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:   3%|3         | 21.0M/605M [00:01<00:30, 19.1MB/s]Downloading (…)ip_pytorch_model.bin:   5%|5         | 31.5M/605M [00:01<00:31, 18.5MB/s]Downloading (…)ip_pytorch_model.bin:   7%|6         | 41.9M/605M [00:02<00:33, 16.6MB/s]Downloading (…)ip_pytorch_model.bin:   9%|8         | 52.4M/605M [00:03<00:35, 15.8MB/s]Downloading (…)ip_pytorch_model.bin:  10%|#         | 62.9M/605M [00:03<00:35, 15.3MB/s]Downloading (…)ip_pytorch_model.bin:  12%|#2        | 73.4M/605M [00:04<00:35, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:  14%|#3        | 83.9M/605M [00:05<00:35, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  16%|#5        | 94.4M/605M [00:06<00:34, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  17%|#7        | 105M/605M [00:06<00:34, 14.7MB/s] Downloading (…)ip_pytorch_model.bin:  19%|#9        | 115M/605M [00:07<00:33, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  21%|##        | 126M/605M [00:08<00:32, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  23%|##2       | 136M/605M [00:08<00:32, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  24%|##4       | 147M/605M [00:09<00:31, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  26%|##5       | 157M/605M [00:10<00:30, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  28%|##7       | 168M/605M [00:11<00:30, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  29%|##9       | 178M/605M [00:12<00:31, 13.5MB/s]Downloading (…)ip_pytorch_model.bin:  31%|###1      | 189M/605M [00:12<00:30, 13.5MB/s]Downloading (…)ip_pytorch_model.bin:  33%|###2      | 199M/605M [00:13<00:27, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  35%|###4      | 210M/605M [00:14<00:26, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  36%|###6      | 220M/605M [00:14<00:25, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:  38%|###8      | 231M/605M [00:15<00:25, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  40%|###9      | 241M/605M [00:16<00:24, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  42%|####1     | 252M/605M [00:16<00:24, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  43%|####3     | 262M/605M [00:17<00:23, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  45%|####5     | 273M/605M [00:18<00:23, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  47%|####6     | 283M/605M [00:19<00:22, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  49%|####8     | 294M/605M [00:19<00:21, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  50%|#####     | 304M/605M [00:20<00:20, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  52%|#####1    | 315M/605M [00:21<00:20, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  54%|#####3    | 325M/605M [00:22<00:19, 14.2MB/s]Downloading (…)ip_pytorch_model.bin:  55%|#####5    | 336M/605M [00:22<00:18, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  57%|#####7    | 346M/605M [00:23<00:17, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  59%|#####8    | 357M/605M [00:24<00:17, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  61%|######    | 367M/605M [00:24<00:16, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  62%|######2   | 377M/605M [00:25<00:15, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  64%|######4   | 388M/605M [00:26<00:15, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  66%|######5   | 398M/605M [00:27<00:14, 14.3MB/s]Downloading (…)ip_pytorch_model.bin:  68%|######7   | 409M/605M [00:27<00:13, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  69%|######9   | 419M/605M [00:28<00:12, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  71%|#######1  | 430M/605M [00:29<00:12, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  73%|#######2  | 440M/605M [00:30<00:11, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  74%|#######4  | 451M/605M [00:30<00:10, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  76%|#######6  | 461M/605M [00:31<00:09, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  78%|#######7  | 472M/605M [00:32<00:10, 13.2MB/s]Downloading (…)ip_pytorch_model.bin:  80%|#######9  | 482M/605M [00:32<00:08, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  81%|########1 | 493M/605M [00:33<00:08, 14.0MB/s]Downloading (…)ip_pytorch_model.bin:  83%|########3 | 503M/605M [00:34<00:06, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:  85%|########4 | 514M/605M [00:35<00:06, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  87%|########6 | 524M/605M [00:35<00:05, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  88%|########8 | 535M/605M [00:36<00:04, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  90%|######### | 545M/605M [00:37<00:04, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  92%|#########1| 556M/605M [00:38<00:03, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  94%|#########3| 566M/605M [00:38<00:02, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  95%|#########5| 577M/605M [00:39<00:01, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  97%|#########7| 587M/605M [00:40<00:01, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  99%|#########8| 598M/605M [00:40<00:00, 14.2MB/s]Downloading (…)ip_pytorch_model.bin: 100%|##########| 605M/605M [00:41<00:00, 14.6MB/s]Downloading (…)ip_pytorch_model.bin: 100%|##########| 605M/605M [00:41<00:00, 14.6MB/s]
Traceback (most recent call last):
  File "custom_dan.py", line 850, in <module>
    main(args)
  File "custom_dan.py", line 585, in main
    lr_scheduler, epoch, args)
  File "custom_dan.py", line 711, in train
    y_s, f_s = model(x_s)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/tllib/modules/classifier.py", line 81, in forward
    f = self.bottleneck(f)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (8x1 and 768x256)
