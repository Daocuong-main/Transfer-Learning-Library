Namespace(arch='resnet50', batch_size=16, bottleneck_dim=256, data='Both', epochs=2, iters_per_epoch=1, kich_ban='S2T', label=3, log='Test/', loss_function='MKME', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scratch=False, seed=None, trade_off=1.0, wd=0.0005, workers=2)
Concate data
=> using model 'resnet50'
f_s
tensor([[0.1712, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.9288, 0.6030,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.3886, 0.0000, 0.2102],
        [0.0000, 0.0000, 0.0000,  ..., 0.3111, 0.0000, 0.0770]],
       device='cuda:0', grad_fn=<NativeDropoutBackward0>)
f_t
tensor([[0.0000, 0.6143, 0.0000,  ..., 0.0000, 0.0000, 0.2508],
        [0.0000, 0.0098, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5765, 0.1122,  ..., 0.2574, 0.0000, 0.0000],
        ...,
        [0.0000, 0.5363, 0.7209,  ..., 0.6919, 0.0000, 0.0000],
        [0.0000, 1.1546, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 1.1374, 0.0000, 0.0000]],
       device='cuda:0', grad_fn=<NativeDropoutBackward0>)
Epoch: [0][0/1]	Time 1.52 (1.52)	Data 0.0 (0.0)	Loss 1.14 (1.14)	Trans Loss 0.0000 (0.0000)	Cls Acc 31.2 (31.2)
Test: [ 0/93]	Time  0.116 ( 0.116)	Loss 1.1174e+00 (1.1174e+00)	Acc@1   0.00 (  0.00)
 * Acc@1 18.200
 * F1 macro = 0.15330
 * F1 micro= 0.18200
 * precision macro= 0.18566
 * precision micro= 0.18200
 * recall macro = 0.17727
 * recall micro = 0.18200
global correct: 18.2
mean correct:33.9
mean IoU: 6.4
+----------------+--------------------+--------------------+
|     class      |        acc         |        iou         |
+----------------+--------------------+--------------------+
|   Ecommerce    | 0.6281406879425049 | 0.6281406879425049 |
|     Video      |       100.0        | 17.735334396362305 |
| Google_Service | 0.9478673338890076 | 0.9411764144897461 |
+----------------+--------------------+--------------------+
f_s
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.3919, 0.0000, 0.0000],
        [0.0000, 0.6114, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.3491, 0.0000,  ..., 0.1528, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.1265],
        [0.0000, 0.0000, 0.0000,  ..., 0.1637, 0.0000, 0.1503],
        [0.0000, 0.0000, 0.5632,  ..., 0.7015, 0.0000, 0.0000]],
       device='cuda:0', grad_fn=<NativeDropoutBackward0>)
f_t
tensor([[0.0000, 0.0000, 0.2861,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.7799, 0.3225,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.8266, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.4323,  ..., 0.5132, 0.0000, 0.0000],
        [0.0355, 0.0000, 0.0000,  ..., 0.4174, 0.0000, 0.0000],
        [0.0000, 0.1538, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0', grad_fn=<NativeDropoutBackward0>)
Epoch: [1][0/1]	Time 0.09 (0.09)	Data 0.0 (0.0)	Loss 1.10 (1.10)	Trans Loss 0.0000 (0.0000)	Cls Acc 31.2 (31.2)
Test: [ 0/93]	Time  0.168 ( 0.168)	Loss 1.1202e+00 (1.1202e+00)	Acc@1   0.00 (  0.00)
 * Acc@1 17.997
 * F1 macro = 0.15139
 * F1 micro= 0.17997
 * precision macro= 0.16942
 * precision micro= 0.17997
 * recall macro = 0.17625
 * recall micro = 0.17997
global correct: 18.0
mean correct:33.6
mean IoU: 6.2
+----------------+--------------------+--------------------+
|     class      |        acc         |        iou         |
+----------------+--------------------+--------------------+
|   Ecommerce    | 0.6281406879425049 | 0.6281406879425049 |
|     Video      |       100.0        | 17.675050735473633 |
| Google_Service | 0.2369668334722519 | 0.2364066243171692 |
+----------------+--------------------+--------------------+
Elapsed time: 00:00:7.377
best_acc1 = 18.20027
Test: [ 0/93]	Time  0.172 ( 0.172)	Loss 1.1174e+00 (1.1174e+00)	Acc@1   0.00 (  0.00)
 * Acc@1 18.200
 * F1 macro = 0.15330
 * F1 micro= 0.18200
 * precision macro= 0.18566
 * precision micro= 0.18200
 * recall macro = 0.17727
 * recall micro = 0.18200
global correct: 18.2
mean correct:33.9
mean IoU: 6.4
+----------------+--------------------+--------------------+
|     class      |        acc         |        iou         |
+----------------+--------------------+--------------------+
|   Ecommerce    | 0.6281406879425049 | 0.6281406879425049 |
|     Video      |       100.0        | 17.735334396362305 |
| Google_Service | 0.9478673338890076 | 0.9411764144897461 |
+----------------+--------------------+--------------------+
Test result below...
test_acc1 = 18.20027
F1 macro = 0.15330
F1 micro= 0.18200
precision macro= 0.18566
precision micro= 0.18200
recall macro = 0.17727
recall micro = 0.18200
avg_time = 2.96774
min_time = 2.00000
max_time = 13.00000
                precision    recall  f1-score   support

     Ecommerce    1.00000   0.00628   0.01248       796
         Video    0.17735   1.00000   0.30127       260
Google_Service    0.57143   0.00948   0.01865       422

      accuracy                        0.18200      1478
     macro avg    0.58293   0.33859   0.11080      1478
  weighted avg    0.73292   0.18200   0.06505      1478

