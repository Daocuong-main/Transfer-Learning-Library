Namespace(arch='wide_resnet101_2', batch_size=8, bottleneck_dim=256, byte_size=32, data='Both', epochs=3, iters_per_epoch=10, label=3, log='Test/', loss_function='MKMMD', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scenario='S2T', scratch=False, seed=None, test_statistic='none', trade_off=1.0, wd=0.0005, workers=2)
Concate data
num_classes: 3
=> using model 'wide_resnet101_2'
Downloading: "https://download.pytorch.org/models/wide_resnet101_2-32ee1156.pth" to /home/bkcs/.cache/torch/hub/checkpoints/wide_resnet101_2-32ee1156.pth
  0%|          | 0.00/243M [00:00<?, ?B/s]  0%|          | 8.00k/243M [00:00<1:43:17, 41.1kB/s]  0%|          | 64.0k/243M [00:00<23:36, 180kB/s]     0%|          | 144k/243M [00:00<15:06, 281kB/s]   0%|          | 304k/243M [00:01<12:05, 351kB/s]  1%|          | 1.29M/243M [00:01<02:49, 1.50MB/s]  1%|1         | 2.59M/243M [00:01<01:19, 3.19MB/s]  2%|1         | 4.70M/243M [00:01<00:38, 6.43MB/s]  2%|2         | 5.70M/243M [00:01<00:36, 6.90MB/s]  3%|3         | 7.81M/243M [00:01<00:25, 9.61MB/s]  4%|4         | 9.87M/243M [00:01<00:20, 12.2MB/s]  5%|4         | 11.3M/243M [00:02<00:26, 9.33MB/s]  5%|5         | 12.8M/243M [00:02<00:24, 9.91MB/s]  6%|6         | 15.3M/243M [00:02<00:23, 10.0MB/s]  8%|7         | 19.1M/243M [00:02<00:15, 15.4MB/s]  9%|8         | 21.0M/243M [00:02<00:14, 15.7MB/s]  9%|9         | 22.9M/243M [00:02<00:15, 15.0MB/s] 11%|#         | 26.2M/243M [00:03<00:11, 19.4MB/s] 12%|#1        | 28.4M/243M [00:03<00:12, 17.7MB/s] 13%|#2        | 30.5M/243M [00:03<00:14, 15.6MB/s] 13%|#3        | 32.2M/243M [00:03<00:18, 12.1MB/s] 14%|#4        | 34.3M/243M [00:03<00:16, 12.9MB/s] 15%|#5        | 37.4M/243M [00:03<00:12, 16.8MB/s] 16%|#6        | 39.3M/243M [00:04<00:13, 16.0MB/s] 17%|#7        | 42.0M/243M [00:04<00:15, 13.2MB/s] 19%|#8        | 45.8M/243M [00:04<00:11, 17.9MB/s] 20%|##        | 49.1M/243M [00:04<00:13, 14.8MB/s] 21%|##        | 50.9M/243M [00:04<00:13, 15.2MB/s] 22%|##1       | 52.9M/243M [00:05<00:16, 12.0MB/s] 23%|##2       | 54.8M/243M [00:05<00:15, 12.7MB/s] 24%|##3       | 57.6M/243M [00:05<00:16, 11.9MB/s] 25%|##4       | 60.5M/243M [00:05<00:13, 13.9MB/s] 26%|##6       | 63.3M/243M [00:05<00:14, 12.9MB/s] 27%|##7       | 66.2M/243M [00:06<00:12, 14.7MB/s] 28%|##8       | 69.2M/243M [00:06<00:13, 13.6MB/s] 30%|##9       | 71.8M/243M [00:06<00:12, 14.5MB/s] 31%|###       | 74.8M/243M [00:06<00:12, 13.8MB/s] 32%|###1      | 77.5M/243M [00:06<00:11, 14.6MB/s] 33%|###3      | 80.5M/243M [00:07<00:13, 12.2MB/s] 34%|###4      | 82.6M/243M [00:07<00:12, 13.3MB/s] 35%|###4      | 84.1M/243M [00:07<00:19, 8.67MB/s] 36%|###5      | 87.4M/243M [00:07<00:13, 12.2MB/s] 37%|###6      | 89.1M/243M [00:08<00:12, 12.7MB/s] 37%|###7      | 90.9M/243M [00:08<00:11, 13.8MB/s] 38%|###8      | 92.6M/243M [00:08<00:11, 14.1MB/s] 39%|###8      | 94.3M/243M [00:08<00:11, 14.0MB/s] 39%|###9      | 95.8M/243M [00:08<00:10, 14.3MB/s] 40%|####      | 97.3M/243M [00:08<00:10, 14.5MB/s] 41%|####      | 98.8M/243M [00:08<00:10, 14.4MB/s] 41%|####1     | 100M/243M [00:08<00:10, 14.5MB/s]  42%|####1     | 102M/243M [00:08<00:10, 14.4MB/s] 42%|####2     | 103M/243M [00:09<00:10, 13.8MB/s] 43%|####2     | 104M/243M [00:09<00:10, 13.8MB/s] 44%|####3     | 106M/243M [00:09<00:10, 14.1MB/s] 44%|####4     | 107M/243M [00:09<00:09, 14.3MB/s] 45%|####4     | 109M/243M [00:09<00:09, 14.3MB/s] 45%|####5     | 110M/243M [00:09<00:09, 14.8MB/s] 46%|####6     | 112M/243M [00:09<00:09, 14.4MB/s] 47%|####6     | 113M/243M [00:09<00:09, 14.3MB/s] 47%|####7     | 114M/243M [00:09<00:09, 13.7MB/s] 48%|####7     | 116M/243M [00:09<00:09, 14.4MB/s] 48%|####8     | 118M/243M [00:10<00:08, 14.6MB/s] 49%|####8     | 119M/243M [00:10<00:08, 14.5MB/s] 50%|####9     | 120M/243M [00:10<00:09, 13.6MB/s] 50%|#####     | 122M/243M [00:10<00:09, 14.0MB/s] 51%|#####     | 123M/243M [00:10<00:08, 14.5MB/s] 51%|#####1    | 125M/243M [00:10<00:09, 13.6MB/s] 52%|#####1    | 126M/243M [00:10<00:08, 14.1MB/s] 52%|#####2    | 128M/243M [00:10<00:09, 13.4MB/s] 53%|#####3    | 129M/243M [00:10<00:08, 13.7MB/s] 54%|#####3    | 130M/243M [00:11<00:08, 13.9MB/s] 54%|#####4    | 132M/243M [00:11<00:08, 13.1MB/s] 55%|#####4    | 133M/243M [00:11<00:08, 13.1MB/s] 55%|#####5    | 134M/243M [00:11<00:08, 13.9MB/s] 56%|#####6    | 136M/243M [00:11<00:07, 14.7MB/s] 57%|#####6    | 138M/243M [00:11<00:06, 16.3MB/s] 57%|#####7    | 140M/243M [00:11<00:07, 14.3MB/s] 58%|#####8    | 141M/243M [00:11<00:06, 15.7MB/s] 59%|#####8    | 143M/243M [00:11<00:06, 15.0MB/s] 59%|#####9    | 144M/243M [00:12<00:07, 14.4MB/s] 60%|######    | 146M/243M [00:12<00:07, 14.1MB/s] 61%|######    | 147M/243M [00:12<00:07, 14.1MB/s] 61%|######1   | 149M/243M [00:12<00:07, 13.8MB/s] 62%|######1   | 150M/243M [00:12<00:07, 13.9MB/s] 62%|######2   | 151M/243M [00:12<00:07, 13.6MB/s] 63%|######2   | 153M/243M [00:12<00:07, 12.6MB/s] 63%|######3   | 154M/243M [00:12<00:07, 11.7MB/s] 64%|######3   | 155M/243M [00:12<00:07, 11.8MB/s] 64%|######4   | 156M/243M [00:13<00:07, 12.3MB/s] 65%|######4   | 158M/243M [00:13<00:07, 12.4MB/s] 65%|######5   | 159M/243M [00:13<00:10, 8.60MB/s] 66%|######5   | 160M/243M [00:13<00:09, 8.90MB/s] 66%|######6   | 161M/243M [00:13<00:08, 10.2MB/s] 67%|######7   | 164M/243M [00:13<00:05, 14.6MB/s] 68%|######8   | 165M/243M [00:13<00:05, 14.8MB/s] 69%|######8   | 167M/243M [00:13<00:05, 13.9MB/s] 69%|######9   | 169M/243M [00:14<00:05, 14.5MB/s] 70%|######9   | 170M/243M [00:14<00:05, 14.1MB/s] 71%|#######   | 171M/243M [00:14<00:05, 13.5MB/s] 71%|#######1  | 173M/243M [00:14<00:05, 13.1MB/s] 72%|#######1  | 174M/243M [00:14<00:05, 13.5MB/s] 72%|#######2  | 175M/243M [00:14<00:05, 13.4MB/s] 73%|#######2  | 177M/243M [00:14<00:05, 13.0MB/s] 73%|#######3  | 178M/243M [00:14<00:05, 13.1MB/s] 74%|#######3  | 179M/243M [00:14<00:05, 13.3MB/s] 74%|#######4  | 181M/243M [00:15<00:05, 12.7MB/s] 75%|#######4  | 182M/243M [00:15<00:05, 12.6MB/s] 75%|#######5  | 183M/243M [00:15<00:04, 12.8MB/s] 76%|#######5  | 184M/243M [00:15<00:04, 13.0MB/s] 76%|#######6  | 186M/243M [00:15<00:04, 13.0MB/s] 77%|#######6  | 187M/243M [00:15<00:04, 12.9MB/s] 77%|#######7  | 188M/243M [00:15<00:04, 13.0MB/s] 78%|#######8  | 189M/243M [00:15<00:04, 12.9MB/s] 79%|#######8  | 191M/243M [00:15<00:04, 13.2MB/s] 79%|#######9  | 192M/243M [00:15<00:04, 13.2MB/s] 80%|#######9  | 193M/243M [00:16<00:03, 13.0MB/s] 80%|########  | 195M/243M [00:16<00:03, 12.9MB/s] 81%|########  | 196M/243M [00:16<00:03, 12.8MB/s] 81%|########1 | 197M/243M [00:16<00:03, 12.8MB/s] 82%|########1 | 198M/243M [00:16<00:03, 12.6MB/s] 82%|########2 | 200M/243M [00:16<00:03, 12.7MB/s] 83%|########2 | 201M/243M [00:16<00:03, 13.0MB/s] 83%|########3 | 202M/243M [00:16<00:03, 13.0MB/s] 84%|########3 | 204M/243M [00:16<00:03, 12.8MB/s] 84%|########4 | 205M/243M [00:17<00:03, 12.9MB/s] 85%|########4 | 206M/243M [00:17<00:03, 12.8MB/s] 85%|########5 | 207M/243M [00:17<00:02, 12.8MB/s] 86%|########5 | 209M/243M [00:17<00:02, 12.7MB/s] 86%|########6 | 210M/243M [00:17<00:02, 12.7MB/s] 87%|########6 | 211M/243M [00:17<00:02, 13.0MB/s] 88%|########7 | 213M/243M [00:17<00:02, 13.7MB/s] 88%|########8 | 214M/243M [00:17<00:02, 13.9MB/s] 89%|########8 | 216M/243M [00:17<00:02, 13.4MB/s] 89%|########9 | 217M/243M [00:17<00:02, 13.3MB/s] 90%|########9 | 218M/243M [00:18<00:02, 12.9MB/s] 90%|######### | 219M/243M [00:18<00:01, 12.8MB/s] 91%|######### | 221M/243M [00:18<00:01, 12.7MB/s] 91%|#########1| 222M/243M [00:18<00:01, 12.9MB/s] 92%|#########1| 223M/243M [00:18<00:01, 13.1MB/s] 92%|#########2| 224M/243M [00:18<00:01, 13.0MB/s] 93%|#########2| 226M/243M [00:18<00:01, 12.6MB/s] 93%|#########3| 227M/243M [00:18<00:01, 13.0MB/s] 94%|#########3| 228M/243M [00:18<00:01, 12.6MB/s] 95%|#########4| 230M/243M [00:19<00:01, 13.3MB/s] 95%|#########5| 231M/243M [00:19<00:00, 12.9MB/s] 96%|#########5| 232M/243M [00:19<00:00, 12.8MB/s] 96%|#########6| 234M/243M [00:19<00:00, 12.9MB/s] 97%|#########6| 235M/243M [00:19<00:00, 14.1MB/s] 97%|#########7| 237M/243M [00:19<00:00, 13.5MB/s] 98%|#########7| 238M/243M [00:19<00:00, 13.7MB/s] 98%|#########8| 239M/243M [00:19<00:00, 13.5MB/s] 99%|#########9| 241M/243M [00:19<00:00, 13.5MB/s]100%|#########9| 242M/243M [00:19<00:00, 14.6MB/s]100%|##########| 243M/243M [00:20<00:00, 12.7MB/s]
Epoch: [0][ 0/10]	Time 1.43 (1.43)	Data 0.0 (0.0)	Loss 1.33 (1.33)	Trans Loss 0.2216 (0.2216)	Cls Acc 50.0 (50.0)
Test: [  0/185]	Time  0.062 ( 0.062)	Loss 1.0144e+00 (1.0144e+00)	Acc@1  12.50 ( 12.50)
Test: [100/185]	Time  0.009 ( 0.011)	Loss 8.7419e-01 (9.1282e-01)	Acc@1  37.50 ( 45.92)
 * Acc@1 29.56698
 * F1 macro = 0.21855
 * F1 micro= 0.29567
 * precision macro= 0.36271
 * precision micro= 0.29567
 * recall macro = 0.18510
 * recall micro = 0.29567
global correct: 29.6
mean correct:36.4
mean IoU: 13.9
+------------------+--------------------+--------------------+
|      class       |        acc         |        iou         |
+------------------+--------------------+--------------------+
|    E-commerce    | 28.517589569091797 | 21.80595588684082  |
| Video on-demand  | 80.76922607421875  | 19.886363983154297 |
| Interactive data |        0.0         |        0.0         |
+------------------+--------------------+--------------------+
Epoch: [1][ 0/10]	Time 0.06 (0.06)	Data 0.0 (0.0)	Loss 1.28 (1.28)	Trans Loss 0.1594 (0.1594)	Cls Acc 50.0 (50.0)
Test: [  0/185]	Time  0.112 ( 0.112)	Loss 1.7746e+00 (1.7746e+00)	Acc@1   0.00 (  0.00)
Test: [100/185]	Time  0.009 ( 0.010)	Loss 2.0512e+00 (1.2947e+00)	Acc@1   0.00 ( 32.18)
 * Acc@1 17.59134
 * F1 macro = 0.15929
 * F1 micro= 0.17591
 * precision macro= 0.15291
 * precision micro= 0.17591
 * recall macro = 0.17591
 * recall micro = 0.17591
global correct: 17.6
mean correct:33.3
mean IoU: 5.9
+------------------+-------+--------------------+
|      class       |  acc  |        iou         |
+------------------+-------+--------------------+
|    E-commerce    |  0.0  |        0.0         |
| Video on-demand  | 100.0 | 17.591339111328125 |
| Interactive data |  0.0  |        0.0         |
+------------------+-------+--------------------+
Epoch: [2][ 0/10]	Time 0.06 (0.06)	Data 0.0 (0.0)	Loss 1.12 (1.12)	Trans Loss 0.2331 (0.2331)	Cls Acc 62.5 (62.5)
Test: [  0/185]	Time  0.062 ( 0.062)	Loss 1.0440e+00 (1.0440e+00)	Acc@1  25.00 ( 25.00)
Test: [100/185]	Time  0.009 ( 0.010)	Loss 9.1899e-01 (9.3349e-01)	Acc@1  37.50 ( 61.76)
 * Acc@1 40.18945
 * F1 macro = 0.29548
 * F1 micro= 0.40189
 * precision macro= 0.40234
 * precision micro= 0.40189
 * recall macro = 0.26054
 * recall micro = 0.40189
global correct: 40.2
mean correct:45.0
mean IoU: 20.7
+------------------+--------------------+--------------------+
|      class       |        acc         |        iou         |
+------------------+--------------------+--------------------+
|    E-commerce    | 45.226131439208984 | 38.420494079589844 |
| Video on-demand  | 89.23076629638672  | 23.223222732543945 |
| Interactive data | 0.4739336669445038 | 0.4694835841655731 |
+------------------+--------------------+--------------------+
Elapsed time: 24.65323543548584
best_acc1 = 40.18945
Test: [  0/185]	Time  0.062 ( 0.062)	Loss 1.0440e+00 (1.0440e+00)	Acc@1  25.00 ( 25.00)
Test: [100/185]	Time  0.009 ( 0.010)	Loss 9.1899e-01 (9.3349e-01)	Acc@1  37.50 ( 61.76)
 * Acc@1 40.18945
 * F1 macro = 0.29548
 * F1 micro= 0.40189
 * precision macro= 0.40234
 * precision micro= 0.40189
 * recall macro = 0.26054
 * recall micro = 0.40189
global correct: 40.2
mean correct:45.0
mean IoU: 20.7
+------------------+--------------------+--------------------+
|      class       |        acc         |        iou         |
+------------------+--------------------+--------------------+
|    E-commerce    | 45.226131439208984 | 38.420494079589844 |
| Video on-demand  | 89.23076629638672  | 23.223222732543945 |
| Interactive data | 0.4739336669445038 | 0.4694835841655731 |
+------------------+--------------------+--------------------+
Test result below...
test_acc1 = 40.18945
F1 macro = 0.29548
F1 micro= 0.40189
precision macro= 0.40234
precision micro= 0.40189
recall macro = 0.26054
recall micro = 0.40189
avg_time = 4.51351
min_time = 4.00000
max_time = 8.00000
                  precision    recall  f1-score   support

      E-commerce    0.71856   0.45226   0.55513       796
 Video on-demand    0.23893   0.89231   0.37693       260
Interactive data    0.33333   0.00474   0.00935       422

        accuracy                        0.40189      1478
       macro avg    0.43028   0.44977   0.31380      1478
    weighted avg    0.52420   0.40189   0.36795      1478

