Namespace(arch='vit_large_patch14_224_clip_laion2b', batch_size=8, bottleneck_dim=256, byte_size=256, data='Both', epochs=2, iters_per_epoch=2, label=3, log='Test/', loss_function='MKMMD', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scenario='S2T', scratch=False, seed=None, test_statistic='none', trade_off=1.0, wd=0.0005, workers=2)
Concate data
num_classes: 3
=> using model 'vit_large_patch14_224_clip_laion2b'
Downloading (…)ip_pytorch_model.bin:   0%|          | 0.00/1.71G [00:00<?, ?B/s]Downloading (…)ip_pytorch_model.bin:   1%|          | 10.5M/1.71G [00:00<02:21, 12.0MB/s]Downloading (…)ip_pytorch_model.bin:   1%|1         | 21.0M/1.71G [00:01<01:37, 17.3MB/s]Downloading (…)ip_pytorch_model.bin:   2%|1         | 31.5M/1.71G [00:01<01:40, 16.7MB/s]Downloading (…)ip_pytorch_model.bin:   2%|2         | 41.9M/1.71G [00:02<01:44, 16.0MB/s]Downloading (…)ip_pytorch_model.bin:   3%|3         | 52.4M/1.71G [00:03<01:48, 15.3MB/s]Downloading (…)ip_pytorch_model.bin:   4%|3         | 62.9M/1.71G [00:04<01:49, 15.0MB/s]Downloading (…)ip_pytorch_model.bin:   4%|4         | 73.4M/1.71G [00:04<01:50, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:   5%|4         | 83.9M/1.71G [00:05<01:50, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:   6%|5         | 94.4M/1.71G [00:06<01:50, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:   6%|6         | 105M/1.71G [00:07<01:50, 14.6MB/s] Downloading (…)ip_pytorch_model.bin:   7%|6         | 115M/1.71G [00:07<01:50, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:   7%|7         | 126M/1.71G [00:08<01:48, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:   8%|7         | 136M/1.71G [00:09<01:48, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:   9%|8         | 147M/1.71G [00:09<01:47, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:   9%|9         | 157M/1.71G [00:10<01:47, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  10%|9         | 168M/1.71G [00:11<01:55, 13.4MB/s]Downloading (…)ip_pytorch_model.bin:  10%|#         | 178M/1.71G [00:12<01:43, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  11%|#1        | 189M/1.71G [00:12<01:43, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  12%|#1        | 199M/1.71G [00:13<01:43, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  12%|#2        | 210M/1.71G [00:14<01:42, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  13%|#2        | 220M/1.71G [00:14<01:42, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  13%|#3        | 231M/1.71G [00:15<01:41, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  14%|#4        | 241M/1.71G [00:16<01:41, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  15%|#4        | 252M/1.71G [00:17<01:40, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  15%|#5        | 262M/1.71G [00:17<01:39, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  16%|#5        | 273M/1.71G [00:18<01:39, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  17%|#6        | 283M/1.71G [00:19<01:38, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  17%|#7        | 294M/1.71G [00:20<01:37, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  18%|#7        | 304M/1.71G [00:20<01:37, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  18%|#8        | 315M/1.71G [00:21<01:36, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  19%|#9        | 325M/1.71G [00:22<01:47, 12.9MB/s]Downloading (…)ip_pytorch_model.bin:  20%|#9        | 336M/1.71G [00:22<01:31, 15.0MB/s]Downloading (…)ip_pytorch_model.bin:  20%|##        | 346M/1.71G [00:23<01:33, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  21%|##        | 357M/1.71G [00:24<01:32, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  21%|##1       | 367M/1.71G [00:25<01:31, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  22%|##2       | 377M/1.71G [00:25<01:31, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  23%|##2       | 388M/1.71G [00:26<01:30, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  23%|##3       | 398M/1.71G [00:27<01:30, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  24%|##3       | 409M/1.71G [00:28<01:34, 13.8MB/s]Downloading (…)ip_pytorch_model.bin:  25%|##4       | 419M/1.71G [00:28<01:27, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  25%|##5       | 430M/1.71G [00:29<01:27, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  26%|##5       | 440M/1.71G [00:30<01:27, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  26%|##6       | 451M/1.71G [00:30<01:27, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  27%|##6       | 461M/1.71G [00:31<01:25, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  28%|##7       | 472M/1.71G [00:32<01:31, 13.6MB/s]Downloading (…)ip_pytorch_model.bin:  28%|##8       | 482M/1.71G [00:33<01:22, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  29%|##8       | 493M/1.71G [00:33<01:22, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  29%|##9       | 503M/1.71G [00:34<01:22, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  30%|###       | 514M/1.71G [00:35<01:23, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  31%|###       | 524M/1.71G [00:36<01:21, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  31%|###1      | 535M/1.71G [00:36<01:20, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  32%|###1      | 545M/1.71G [00:37<01:20, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  32%|###2      | 556M/1.71G [00:38<01:19, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  33%|###3      | 566M/1.71G [00:38<01:19, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  34%|###3      | 577M/1.71G [00:39<01:18, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  34%|###4      | 587M/1.71G [00:40<01:17, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  35%|###4      | 598M/1.71G [00:41<01:17, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  36%|###5      | 608M/1.71G [00:41<01:16, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  36%|###6      | 619M/1.71G [00:42<01:15, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  37%|###6      | 629M/1.71G [00:43<01:16, 14.1MB/s]Downloading (…)ip_pytorch_model.bin:  37%|###7      | 640M/1.71G [00:44<01:20, 13.3MB/s]Downloading (…)ip_pytorch_model.bin:  38%|###8      | 650M/1.71G [00:44<01:12, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  39%|###8      | 661M/1.71G [00:45<01:10, 15.0MB/s]Downloading (…)ip_pytorch_model.bin:  39%|###9      | 671M/1.71G [00:46<01:10, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  40%|###9      | 682M/1.71G [00:46<01:09, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  40%|####      | 692M/1.71G [00:47<01:09, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  41%|####1     | 703M/1.71G [00:48<01:09, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  42%|####1     | 713M/1.71G [00:49<01:08, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  42%|####2     | 724M/1.71G [00:49<01:07, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  43%|####2     | 734M/1.71G [00:50<01:07, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  44%|####3     | 744M/1.71G [00:51<01:06, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  44%|####4     | 755M/1.71G [00:51<01:05, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  45%|####4     | 765M/1.71G [00:52<01:06, 14.3MB/s]Downloading (…)ip_pytorch_model.bin:  45%|####5     | 776M/1.71G [00:53<01:04, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  46%|####5     | 786M/1.71G [00:54<01:05, 14.2MB/s]Downloading (…)ip_pytorch_model.bin:  47%|####6     | 797M/1.71G [00:54<01:02, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  47%|####7     | 807M/1.71G [00:55<01:02, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  48%|####7     | 818M/1.71G [00:56<01:01, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  48%|####8     | 828M/1.71G [00:57<01:00, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  49%|####9     | 839M/1.71G [00:57<01:00, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  50%|####9     | 849M/1.71G [00:58<00:59, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  50%|#####     | 860M/1.71G [00:59<00:58, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  51%|#####     | 870M/1.71G [00:59<00:58, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  51%|#####1    | 881M/1.71G [01:00<00:57, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  52%|#####2    | 891M/1.71G [01:01<00:56, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  53%|#####2    | 902M/1.71G [01:02<00:56, 14.2MB/s]Downloading (…)ip_pytorch_model.bin:  53%|#####3    | 912M/1.71G [01:02<00:55, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  54%|#####3    | 923M/1.71G [01:03<00:54, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  55%|#####4    | 933M/1.71G [01:04<01:01, 12.7MB/s]Downloading (…)ip_pytorch_model.bin:  55%|#####5    | 944M/1.71G [01:05<00:54, 14.0MB/s]Downloading (…)ip_pytorch_model.bin:  56%|#####5    | 954M/1.71G [01:05<00:49, 15.3MB/s]Downloading (…)ip_pytorch_model.bin:  56%|#####6    | 965M/1.71G [01:06<00:49, 15.0MB/s]Downloading (…)ip_pytorch_model.bin:  57%|#####7    | 975M/1.71G [01:07<00:49, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  58%|#####7    | 986M/1.71G [01:07<00:49, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  58%|#####8    | 996M/1.71G [01:08<00:48, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  59%|#####8    | 1.01G/1.71G [01:09<00:48, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  59%|#####9    | 1.02G/1.71G [01:10<00:47, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  60%|######    | 1.03G/1.71G [01:10<00:47, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  61%|######    | 1.04G/1.71G [01:11<00:46, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  61%|######1   | 1.05G/1.71G [01:12<00:45, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  62%|######1   | 1.06G/1.71G [01:13<00:44, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  63%|######2   | 1.07G/1.71G [01:13<00:44, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  63%|######3   | 1.08G/1.71G [01:14<00:46, 13.6MB/s]Downloading (…)ip_pytorch_model.bin:  64%|######3   | 1.09G/1.71G [01:15<00:41, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  64%|######4   | 1.10G/1.71G [01:15<00:41, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  65%|######4   | 1.11G/1.71G [01:16<00:41, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  66%|######5   | 1.12G/1.71G [01:17<00:40, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  66%|######6   | 1.13G/1.71G [01:18<00:39, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  67%|######6   | 1.14G/1.71G [01:18<00:39, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  67%|######7   | 1.15G/1.71G [01:19<00:38, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  68%|######8   | 1.16G/1.71G [01:20<00:37, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  69%|######8   | 1.17G/1.71G [01:21<00:36, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  69%|######9   | 1.18G/1.71G [01:21<00:36, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  70%|######9   | 1.20G/1.71G [01:22<00:35, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  70%|#######   | 1.21G/1.71G [01:23<00:35, 14.3MB/s]Downloading (…)ip_pytorch_model.bin:  71%|#######1  | 1.22G/1.71G [01:23<00:34, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  72%|#######1  | 1.23G/1.71G [01:24<00:35, 13.6MB/s]Downloading (…)ip_pytorch_model.bin:  72%|#######2  | 1.24G/1.71G [01:25<00:31, 14.8MB/s]Downloading (…)ip_pytorch_model.bin:  73%|#######2  | 1.25G/1.71G [01:26<00:31, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  74%|#######3  | 1.26G/1.71G [01:26<00:30, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  74%|#######4  | 1.27G/1.71G [01:27<00:30, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  75%|#######4  | 1.28G/1.71G [01:28<00:29, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  75%|#######5  | 1.29G/1.71G [01:29<00:29, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  76%|#######6  | 1.30G/1.71G [01:29<00:28, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  77%|#######6  | 1.31G/1.71G [01:30<00:27, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  77%|#######7  | 1.32G/1.71G [01:31<00:26, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  78%|#######7  | 1.33G/1.71G [01:31<00:26, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  78%|#######8  | 1.34G/1.71G [01:32<00:25, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  79%|#######9  | 1.35G/1.71G [01:33<00:24, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  80%|#######9  | 1.36G/1.71G [01:34<00:23, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  80%|########  | 1.37G/1.71G [01:34<00:25, 13.4MB/s]Downloading (…)ip_pytorch_model.bin:  81%|########  | 1.38G/1.71G [01:35<00:23, 14.2MB/s]Downloading (…)ip_pytorch_model.bin:  82%|########1 | 1.39G/1.71G [01:36<00:23, 13.7MB/s]Downloading (…)ip_pytorch_model.bin:  82%|########2 | 1.41G/1.71G [01:37<00:20, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  83%|########2 | 1.42G/1.71G [01:37<00:21, 14.0MB/s]Downloading (…)ip_pytorch_model.bin:  83%|########3 | 1.43G/1.71G [01:38<00:18, 15.2MB/s]Downloading (…)ip_pytorch_model.bin:  84%|########3 | 1.44G/1.71G [01:39<00:18, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:  85%|########4 | 1.45G/1.71G [01:39<00:17, 14.9MB/s]Downloading (…)ip_pytorch_model.bin:  85%|########5 | 1.46G/1.71G [01:40<00:17, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  86%|########5 | 1.47G/1.71G [01:41<00:16, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  86%|########6 | 1.48G/1.71G [01:42<00:15, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  87%|########7 | 1.49G/1.71G [01:42<00:15, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  88%|########7 | 1.50G/1.71G [01:43<00:14, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  88%|########8 | 1.51G/1.71G [01:44<00:13, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  89%|########8 | 1.52G/1.71G [01:44<00:13, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  89%|########9 | 1.53G/1.71G [01:45<00:13, 13.7MB/s]Downloading (…)ip_pytorch_model.bin:  90%|######### | 1.54G/1.71G [01:46<00:11, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  91%|######### | 1.55G/1.71G [01:47<00:10, 14.7MB/s]Downloading (…)ip_pytorch_model.bin:  91%|#########1| 1.56G/1.71G [01:47<00:10, 14.6MB/s]Downloading (…)ip_pytorch_model.bin:  92%|#########1| 1.57G/1.71G [01:48<00:09, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  93%|#########2| 1.58G/1.71G [01:49<00:08, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  93%|#########3| 1.59G/1.71G [01:50<00:08, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  94%|#########3| 1.60G/1.71G [01:50<00:07, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  94%|#########4| 1.61G/1.71G [01:51<00:06, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  95%|#########5| 1.63G/1.71G [01:52<00:05, 14.4MB/s]Downloading (…)ip_pytorch_model.bin:  96%|#########5| 1.64G/1.71G [01:52<00:05, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  96%|#########6| 1.65G/1.71G [01:53<00:04, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  97%|#########6| 1.66G/1.71G [01:54<00:03, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  97%|#########7| 1.67G/1.71G [01:55<00:03, 14.3MB/s]Downloading (…)ip_pytorch_model.bin:  98%|#########8| 1.68G/1.71G [01:55<00:02, 14.2MB/s]Downloading (…)ip_pytorch_model.bin:  99%|#########8| 1.69G/1.71G [01:56<00:01, 14.5MB/s]Downloading (…)ip_pytorch_model.bin:  99%|#########9| 1.70G/1.71G [01:57<00:00, 14.5MB/s]Downloading (…)ip_pytorch_model.bin: 100%|#########9| 1.71G/1.71G [01:58<00:00, 14.5MB/s]Downloading (…)ip_pytorch_model.bin: 100%|##########| 1.71G/1.71G [01:58<00:00, 14.5MB/s]
Traceback (most recent call last):
  File "custom_dan.py", line 850, in <module>
    main(args)
  File "custom_dan.py", line 585, in main
    lr_scheduler, epoch, args)
  File "custom_dan.py", line 711, in train
    y_s, f_s = model(x_s)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/tllib/modules/classifier.py", line 81, in forward
    f = self.bottleneck(f)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bkcs/miniconda3/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (8x1 and 1024x256)
