Namespace(arch='resnet34', batch_size=8, bottleneck_dim=256, byte_size=32, data='Both', epochs=3, iters_per_epoch=10, label=3, log='Test/', loss_function='MKMMD', lr=0.003, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_pool=False, non_linear=False, per_class_eval=True, phase='train', print_freq=100, random_frequencies=5, scale_parameter=1, scenario='S2T', scratch=False, seed=None, test_statistic='none', trade_off=1.0, wd=0.0005, workers=2)
Concate data
num_classes: 3
=> using model 'resnet34'
Downloading: "https://download.pytorch.org/models/resnet34-b627a593.pth" to /home/bkcs/.cache/torch/hub/checkpoints/resnet34-b627a593.pth
  0%|          | 0.00/83.3M [00:00<?, ?B/s]  3%|2         | 2.31M/83.3M [00:00<00:03, 23.7MB/s]  5%|5         | 4.58M/83.3M [00:00<00:04, 20.4MB/s]  9%|8         | 7.29M/83.3M [00:00<00:03, 23.7MB/s] 12%|#1        | 9.59M/83.3M [00:00<00:03, 22.1MB/s] 14%|#4        | 12.1M/83.3M [00:00<00:03, 22.7MB/s] 18%|#8        | 15.1M/83.3M [00:00<00:02, 25.2MB/s] 22%|##1       | 18.2M/83.3M [00:00<00:02, 27.6MB/s] 25%|##5       | 20.9M/83.3M [00:00<00:02, 22.6MB/s] 28%|##7       | 23.2M/83.3M [00:01<00:03, 19.1MB/s] 30%|###       | 25.2M/83.3M [00:01<00:03, 17.2MB/s] 32%|###2      | 26.9M/83.3M [00:01<00:03, 16.8MB/s] 34%|###4      | 28.6M/83.3M [00:01<00:03, 16.5MB/s] 36%|###6      | 30.3M/83.3M [00:01<00:03, 16.2MB/s] 38%|###8      | 31.8M/83.3M [00:01<00:03, 15.2MB/s] 40%|####      | 33.3M/83.3M [00:01<00:03, 14.7MB/s] 42%|####1     | 34.8M/83.3M [00:01<00:03, 14.7MB/s] 44%|####3     | 36.5M/83.3M [00:02<00:03, 15.4MB/s] 46%|####5     | 37.9M/83.3M [00:02<00:03, 15.3MB/s] 47%|####7     | 39.4M/83.3M [00:02<00:03, 14.9MB/s] 49%|####9     | 40.8M/83.3M [00:02<00:03, 14.6MB/s] 51%|#####     | 42.2M/83.3M [00:02<00:02, 14.6MB/s] 52%|#####2    | 43.6M/83.3M [00:02<00:02, 14.4MB/s] 54%|#####4    | 45.1M/83.3M [00:02<00:02, 14.5MB/s] 56%|#####5    | 46.5M/83.3M [00:02<00:02, 14.5MB/s] 58%|#####7    | 47.9M/83.3M [00:02<00:02, 14.2MB/s] 59%|#####9    | 49.3M/83.3M [00:03<00:02, 14.3MB/s] 61%|######    | 50.8M/83.3M [00:03<00:02, 14.6MB/s] 63%|######2   | 52.2M/83.3M [00:03<00:02, 14.0MB/s] 65%|######4   | 53.8M/83.3M [00:03<00:02, 14.7MB/s] 66%|######6   | 55.2M/83.3M [00:03<00:02, 14.6MB/s] 68%|######7   | 56.6M/83.3M [00:03<00:01, 14.6MB/s] 70%|######9   | 58.0M/83.3M [00:03<00:01, 13.7MB/s] 72%|#######1  | 59.6M/83.3M [00:03<00:01, 14.7MB/s] 73%|#######3  | 61.0M/83.3M [00:03<00:01, 14.7MB/s] 75%|#######5  | 62.5M/83.3M [00:03<00:01, 14.2MB/s] 77%|#######6  | 63.8M/83.3M [00:04<00:01, 14.0MB/s] 78%|#######8  | 65.2M/83.3M [00:04<00:01, 14.1MB/s] 80%|#######9  | 66.6M/83.3M [00:04<00:01, 14.1MB/s] 82%|########1 | 68.2M/83.3M [00:04<00:01, 13.7MB/s] 84%|########4 | 70.0M/83.3M [00:04<00:00, 15.1MB/s] 86%|########5 | 71.5M/83.3M [00:04<00:00, 15.1MB/s] 88%|########7 | 72.9M/83.3M [00:04<00:00, 14.9MB/s] 89%|########9 | 74.4M/83.3M [00:04<00:00, 14.5MB/s] 91%|######### | 75.7M/83.3M [00:04<00:00, 14.4MB/s] 93%|#########2| 77.1M/83.3M [00:05<00:00, 14.1MB/s] 95%|#########4| 78.7M/83.3M [00:05<00:00, 14.7MB/s] 96%|#########6| 80.1M/83.3M [00:05<00:00, 14.4MB/s] 98%|#########7| 81.5M/83.3M [00:05<00:00, 14.3MB/s]100%|#########9| 82.9M/83.3M [00:05<00:00, 14.0MB/s]100%|##########| 83.3M/83.3M [00:05<00:00, 15.9MB/s]
Epoch: [0][ 0/10]	Time 0.97 (0.97)	Data 0.0 (0.0)	Loss 1.62 (1.62)	Trans Loss 0.1133 (0.1133)	Cls Acc 12.5 (12.5)
Test: [  0/185]	Time  0.060 ( 0.060)	Loss 1.0782e+00 (1.0782e+00)	Acc@1  12.50 ( 12.50)
Test: [100/185]	Time  0.004 ( 0.006)	Loss 1.0390e+00 (9.4657e-01)	Acc@1   0.00 ( 48.64)
 * Acc@1 32.00271
 * F1 macro = 0.22558
 * F1 micro= 0.32003
 * precision macro= 0.35596
 * precision micro= 0.32003
 * recall macro = 0.19665
 * recall micro = 0.32003
global correct: 32.0
mean correct:38.7
mean IoU: 15.5
+------------------+--------------------+--------------------+
|      class       |        acc         |        iou         |
+------------------+--------------------+--------------------+
|    E-commerce    | 31.65829086303711  | 25.200000762939453 |
| Video on-demand  | 83.84615325927734  | 20.566038131713867 |
| Interactive data | 0.7109004259109497 | 0.7092198133468628 |
+------------------+--------------------+--------------------+
Epoch: [1][ 0/10]	Time 0.04 (0.04)	Data 0.0 (0.0)	Loss 0.96 (0.96)	Trans Loss 0.1514 (0.1514)	Cls Acc 62.5 (62.5)
Test: [  0/185]	Time  0.123 ( 0.123)	Loss 1.1874e+00 (1.1874e+00)	Acc@1  37.50 ( 37.50)
Test: [100/185]	Time  0.004 ( 0.006)	Loss 9.3849e-01 (9.0155e-01)	Acc@1  62.50 ( 61.88)
 * Acc@1 51.48850
 * F1 macro = 0.27669
 * F1 micro= 0.51488
 * precision macro= 0.39618
 * precision micro= 0.51488
 * recall macro = 0.22975
 * recall micro = 0.51488
global correct: 51.5
mean correct:50.5
mean IoU: 32.4
+------------------+--------------------+-------------------+
|      class       |        acc         |        iou        |
+------------------+--------------------+-------------------+
|    E-commerce    | 59.79899597167969  |  52.1929817199707 |
| Video on-demand  | 63.076927185058594 | 27.42474937438965 |
| Interactive data | 28.67298698425293  | 17.66423225402832 |
+------------------+--------------------+-------------------+
Epoch: [2][ 0/10]	Time 0.04 (0.04)	Data 0.0 (0.0)	Loss 1.31 (1.31)	Trans Loss 0.3288 (0.3288)	Cls Acc 50.0 (50.0)
Test: [  0/185]	Time  0.098 ( 0.098)	Loss 6.2817e-01 (6.2817e-01)	Acc@1  75.00 ( 75.00)
Test: [100/185]	Time  0.004 ( 0.005)	Loss 4.8834e-01 (7.4476e-01)	Acc@1  87.50 ( 69.31)
 * Acc@1 59.60758
 * F1 macro = 0.36579
 * F1 micro= 0.59608
 * precision macro= 0.47482
 * precision micro= 0.59608
 * recall macro = 0.32192
 * recall micro = 0.59608
global correct: 59.6
mean correct:52.5
mean IoU: 37.4
+------------------+-------------------+--------------------+
|      class       |        acc        |        iou         |
+------------------+-------------------+--------------------+
|    E-commerce    |  78.2663345336914 | 62.739173889160156 |
| Video on-demand  | 46.92307662963867 | 29.04762077331543  |
| Interactive data | 32.22748947143555 | 20.543806076049805 |
+------------------+-------------------+--------------------+
Elapsed time: 7.490193128585815
best_acc1 = 59.60758
Test: [  0/185]	Time  0.077 ( 0.077)	Loss 6.2817e-01 (6.2817e-01)	Acc@1  75.00 ( 75.00)
Test: [100/185]	Time  0.004 ( 0.005)	Loss 4.8834e-01 (7.4476e-01)	Acc@1  87.50 ( 69.31)
 * Acc@1 59.60758
 * F1 macro = 0.36579
 * F1 micro= 0.59608
 * precision macro= 0.47482
 * precision micro= 0.59608
 * recall macro = 0.32192
 * recall micro = 0.59608
global correct: 59.6
mean correct:52.5
mean IoU: 37.4
+------------------+-------------------+--------------------+
|      class       |        acc        |        iou         |
+------------------+-------------------+--------------------+
|    E-commerce    |  78.2663345336914 | 62.739173889160156 |
| Video on-demand  | 46.92307662963867 | 29.04762077331543  |
| Interactive data | 32.22748947143555 | 20.543806076049805 |
+------------------+-------------------+--------------------+
Test result below...
test_acc1 = 59.60758
F1 macro = 0.36579
F1 micro= 0.59608
precision macro= 0.47482
precision micro= 0.59608
recall macro = 0.32192
recall micro = 0.59608
avg_time = 1.85946
min_time = 1.00000
max_time = 4.00000
                  precision    recall  f1-score   support

      E-commerce    0.75976   0.78266   0.77104       796
 Video on-demand    0.43262   0.46923   0.45018       260
Interactive data    0.36170   0.32227   0.34085       422

        accuracy                        0.59608      1478
       macro avg    0.51803   0.52472   0.52069      1478
    weighted avg    0.58856   0.59608   0.59177      1478

